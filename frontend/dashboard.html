<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Control iD — Dashboard</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@200;300;400;500;600;700&family=Raleway:wght@400;600&display=swap" rel="stylesheet">
  </head>
  <body class="has-bg">
    <header class="topbar topbar-elevated">


      <div class="container header-row">
                      <a href="#" class="brand-corner" aria-label="Autoliv">
        <img src="https://www.autoliv.com/sites/autoliv/themes/boot5/logo.svg" alt="Autoliv logo" class="brand-logo" />
      </a>
        <div class="header-center">
        </div>

        <div class="header-right">
          <button id="btnAddUserHeader" class="btn icon-button" title="Adicionar usuário" aria-label="Adicionar usuário">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14M5 12h14"/></svg>
          </button>

          <button id="btnRefreshDevices" class="btn icon-button" title="Atualizar relógios" aria-label="Atualizar relógios">
            <img src="https://img.icons8.com/?size=100&id=54312&format=png&color=000000" alt="" width="18">
          </button>

          <div class="user-menu">
            <button id="btnLogout" class="btn icon-button danger" title="Sair" aria-label="Sair">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
            </button>
            <span class="user-name">Administrador</span>
          </div>
        </div>
      </div>
    </header>

    <main class="container">
      <h1 class="page-title">Control iD</h1>
      <section class="panel">
        <div class="panel-header">
          <h2>Gestão de Usuários</h2>
          <div class="panel-actions">
            <button id="btnAddUser" class="btn primary">Adicionar Usuário</button>
          </div>
        </div>

        <div class="panel-body">
          <div class="meta-row">
            <div id="devicesSummary" class="meta-item"></div>
          </div>

            <div class="panel-actions">
              <label for="bulkCpfInput">CPFs (separados por vírgula)</label>
              <input id="bulkCpfInput" placeholder="ex: 12345678901, 10987654321" />
              <button id="btnBulkDelete" class="btn danger">Remover Funcionários</button>
            </div>
        </div>
      </section>

      <section class="panel small" id="operationLogPanel" hidden>
        <div class="panel-header">
          <h3>Resultado da Operação</h3>
          <div>
            <button id="btnCloseLog" class="btn">Fechar</button>
          </div>
        </div>
        <div class="panel-body" id="operationLogBody">
          <!-- Logs por dispositivo -->
        </div>
      </section>
    </main>

    <!-- Modal de usuário -->
    <div id="userModal" class="modal" hidden>
      <div class="modal-content">
        <header class="modal-header">
          <h3 id="modalTitle">Adicionar Usuário</h3>
          <button id="modalClose" type="button" class="btn" aria-label="Fechar">✕</button>
        </header>
        <form id="userForm" class="modal-body">
          <label>CPF</label>
          <input id="fieldCpf" name="cpf" required />

          <label>Nome</label>
          <input id="fieldName" name="name" required />

          <label>Matrícula</label>
          <input id="fieldRegistration" name="registration" />

          <label>RFID</label>
          <input id="fieldRfid" name="rfid" />

          <!-- <label>Admin</label>
          <input id="fieldAdmin" name="admin" type="checkbox" /> -->

          <label>Foto (opcional)</label>
          <div class="photo-input">
            <input id="fieldPhoto" name="photo" type="file" accept="image/*" />
            <label for="fieldPhoto" class="btn secondary" id="photoChoose">Escolher foto</label>
            <button type="button" class="btn small" id="photoClear" style="display:none">Remover</button>
          </div>
          <div style="margin-top:6px; display:flex; gap:10px; align-items:center;">
            <img id="photoPreview" src="" alt="preview" class="photo-preview" />
            <div id="photoHelp" style="font-size:12px; color:var(--muted)">Opcional: selecione uma foto para enviar ao relógio (será redimensionada no navegador).</div>
          </div>

          <div class="modal-actions">
            <button type="submit" class="btn primary" id="modalSave">Salvar</button>
            <button type="button" class="btn" id="modalCancel">Cancelar</button>
          </div>
        </form>
      </div>
    </div>

    <div id="globalLoader" class="global-loader" hidden>
      <div class="global-loader-content">
        <div class="spinner"></div>
        <div class="global-loader-text">Atualizando relógios...</div>
      </div>
    </div>

    <script src="/js/config.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/users.js"></script>
    <div id="snackbarContainer" aria-live="polite" aria-atomic="true"></div>
  </body>
</html>
